import random
import string
from random import randint
from faker import Faker
from random_username.generate import generate_username

class UserFaker:
    domains = ["hotmail.com", "gmail.com", "protonmail.com", "laposte.net", "outlook.fr", "yahoo.com"]
    gender = ["m", "f", "s", "c"]
    letters = string.ascii_lowercase[:26]
    symbols = '~!@#$%^&*()_+`-=,./;[]<>?:'
    usernameSymbols = ['', '_', 'x']
    numbers = '123456789'
    fake = Faker(['fr_FR', 'en_US'])

    def get_random_domain(self, domains):
        return random.choice(self.domains)

    def get_random_string(self, letters, length, special_symbols=False):
        if not special_symbols:
            return ''.join(random.choice(letters) for i in range(length))
        return ''.join(random.choice(letters) for i in range(int(length / 2) + 1)).join(
            random.choice(self.symbols) for i in range(2)).join(random.choice(self.numbers) for i in range(2))

    def get_random_dob(self):
        return str(randint(1, 12)) + "-" + str(randint(1, 28)) + "-" + str(randint(1950, 2003))

    def get_random_gender(self):
        return random.choice(self.gender)

    def get_random_email(self, length):
        return self.get_random_string(self.letters, length) + '@' + self.get_random_domain(self.domains)

    def generate_random_emails(self, nb, length):
        return [self.get_random_string(self.letters, length) + '@' + self.get_random_domain(self.domains) for i in
                range(nb)]

    def generate_random_usernames(self, nb, length):
        return [self.fake.first_name() + '_' + self.get_random_string(self.letters, int(3)) for i
                in range(nb)]
    def generate_random_username(self):
        if random.choice([True, False]):
            username = generate_username()
            return username[0]
        else:
            return self.fake.first_name().lower() + random.choice(self.usernameSymbols) + ''.join([str(randint(0, 9)) for x in range(1, randint(3, 9))])

    def main(self):
        print(self.generate_random_emails(10, 7))
        print("Username:" + self.generate_random_usernames(10, 8))

    def generate_data(self, registration_limit):
        print("Generating random data for " + str(registration_limit))
        return [{'username': self.generate_random_username(),
                 'password': self.get_random_string(self.letters + self.symbols + self.numbers, 12, True),
                 'email': self.get_random_email(random.randint(9, 14)),
                 'dob': self.get_random_dob(),
                 'gender': self.get_random_gender()} for i in range(registration_limit)]

